#pragma once
#include <stdint.h>

#ifdef __cplusplus
extern "C" {
#endif

typedef enum {
    AUTH_OK = 0,
    AUTH_ERR_NOT_CONFIGURED = 1,
    AUTH_ERR_BAD_CREDENTIALS = 2,
    AUTH_ERR_IO = 3,
    AUTH_ERR_CRYPTO = 4,
} auth_status_t;

/* Initialize auth system (safe to call multiple times). */
auth_status_t auth_init(void);

/* Returns 1 if a password hash is stored in QSPI. */
int auth_is_configured(void);

/* Verify a login attempt. Username is currently fixed to "admin" (case-sensitive). */
auth_status_t auth_verify_credentials(const char *username, const char *password);

/* Set/replace the admin password (writes QSPI). */
auth_status_t auth_set_admin_password(const char *new_password);

/* Clear stored credentials (erases auth sector). Use only from a physical recovery path. */
auth_status_t auth_clear(void);

#ifdef __cplusplus
}
#endif
